<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vodafone Wordsearch â€” Multiplayer</title>
<style>
  :root {
    --voda-red:#E60000; --bg:#0c0d10; --panel:#14161a;
    --grid:#2b2e33; --muted:#9aa0a6;
  }
  body {margin:0; background:var(--bg); color:#fff; font-family:Arial, sans-serif;}
  .container {max-width:1200px; margin:auto; padding:16px;}
  .topbar{display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; flex-wrap:wrap;}
  .logo{width:40px; height:40px; border-radius:50%; background:var(--voda-red);}
  .title{font-weight:900; font-size:22px;}
  .toolbar{display:flex; gap:8px; flex-wrap:wrap;}
  .btn{border:none; border-radius:8px; padding:8px 12px; font-weight:700; cursor:pointer;}
  .btn-primary{background:var(--voda-red); color:white;}
  .btn-ghost{background:#222; color:white;}
  .pill{background:#111; padding:6px 10px; border-radius:20px; font-size:13px;}
  .row{display:grid; grid-template-columns:1fr 380px; gap:16px;}
  @media(max-width:1000px){.row{grid-template-columns:1fr}}
  .card{background:var(--panel); border-radius:12px; padding:12px;}
  .card h3{margin-top:0;}
  .grid{display:grid; user-select:none;}
  .cell{width:40px; height:40px; display:flex; align-items:center; justify-content:center;
        border:1px solid #333; font-weight:900; font-size:18px; cursor:pointer; background:#101217;}
  .cell.sel{background:rgba(230,0,0,.3);}
  .cell.found{background:var(--voda-red); color:white;}
  .list{list-style:none; padding:0; margin:0; display:grid; gap:6px;}
  .list li{padding:8px; background:#0f1013; border-radius:8px; border:1px solid #2a2c31; display:flex; justify-content:space-between;}
  .list li.found div{text-decoration:line-through; color:var(--muted);}
  .slots{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;}
  .slot{width:50px; height:50px; border:2px dashed #333; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:20px; font-weight:900; color:#777;}
  .slot.fill{border-style:solid; color:white;}
  .leader{display:grid; gap:6px;}
  .leader-row{display:flex; justify-content:space-between; background:#0f1013; padding:6px 10px; border-radius:8px;}
  #qrcode{margin-top:8px;}
</style>
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="brand">
      <div class="logo"></div>
      <div class="title">Vodafone Wordsearch</div>
    </div>
    <div class="toolbar">
      <button class="btn btn-ghost" id="btnShuffle">Shuffle</button>
      <button class="btn-primary btn" id="btnStart">Start</button>
      <button class="btn btn-ghost" id="btnReset">Reset</button>
      <button class="btn btn-ghost" id="btnNewPlayer">Add Player</button>
      <button class="btn btn-ghost" id="btnNewTeam">Add Team</button>
      <span class="pill">Words left: <span id="hudLeft">0</span></span>
      <span class="pill">Time: <span id="hudTimer">10:00</span></span>
    </div>
  </div>

  <div class="row">
    <!-- LEFT: Grid + Leaderboard -->
    <div class="card">
      <h3>Puzzle</h3>
      <div id="grid" class="grid"></div>
      <h3>Leaderboard</h3>
      <div id="leader" class="leader"></div>
      <h4>Teams</h4>
      <div id="teamList"></div>
      <h4>Players</h4>
      <div id="playerList"></div>
      <div id="qrcode"></div>
    </div>

    <!-- RIGHT: Final phrase + words -->
    <div class="card">
      <h3>Final Phrase</h3>
      <div class="slots" id="slotsWrap"></div>
      <h3>Words to Find</h3>
      <ul id="wordList" class="list"></ul>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
const GRID_SIZE = 12;
const WORDS = [
  {word:"CORE", hint:"Backbone of the network layer"},
  {word:"SITETRACKER", hint:"Deployment operations tool"},
  {word:"ALLOCATION", hint:"Assigning resources to a task"},
  {word:"NCT", hint:"System used to allocate sites"},
  {word:"DELIVERY", hint:"Phase where site is handed over"},
  {word:"LCA", hint:"Pre-build setup team"},
  {word:"CRQ", hint:"Formal change request code"},
  {word:"AUDIT", hint:"Action to ensure accurate site data"},
  {word:"TEAM", hint:"Working together for success"}
];
const TARGET_PHRASE = "CSANDLCATEAM";

// state
let board=[]; let placedWords=[]; let players=[]; let teams=[];
let slotLetters=Array.from(TARGET_PHRASE, ch=>ch===' ' ? ' ' : '');
let bankLetters=[];

// helpers
const $=id=>document.getElementById(id);
function rand(n){return Math.floor(Math.random()*n);}
function shuffle(a){for(let i=a.length-1;i>0;i--){let j=rand(i+1);[a[i],a[j]]=[a[j],a[i]];}return a;}

// board
function newBoard(){
  board=Array.from({length:GRID_SIZE},()=>Array.from({length:GRID_SIZE},()=>({letter:"",found:false})));
  placedWords=[];
  WORDS.forEach(w=>placeWord(w.word));
  for(let r=0;r<GRID_SIZE;r++)for(let c=0;c<GRID_SIZE;c++)if(!board[r][c].letter) board[r][c].letter=String.fromCharCode(65+rand(26));
  renderBoard(); renderWords(); updateHUD(); updateQR();
}
function placeWord(word){
  const dirs=[[1,0],[0,1],[1,1],[1,-1],[-1,0],[0,-1],[-1,-1],[-1,1]];
  for(let t=0;t<300;t++){
    let [dr,dc]=dirs[rand(dirs.length)], r0=rand(GRID_SIZE), c0=rand(GRID_SIZE), ok=true, cells=[];
    for(let i=0;i<word.length;i++){
      let r=r0+dr*i,c=c0+dc*i;
      if(r<0||c<0||r>=GRID_SIZE||c>=GRID_SIZE){ok=false;break;}
      let cell=board[r][c];
      if(cell.letter && cell.letter!==word[i]){ok=false;break;}
      cells.push({r,c});
    }
    if(ok){cells.forEach((p,i)=>board[p.r][p.c].letter=word[i]); placedWords.push({word,cells,found:false}); return;}
  }
}

// render
function renderBoard(){
  const g=$("grid"); g.innerHTML=""; g.style.gridTemplateColumns=`repeat(${GRID_SIZE},40px)`;
  for(let r=0;r<GRID_SIZE;r++)for(let c=0;c<GRID_SIZE;c++){let d=document.createElement("div"); d.className="cell"; d.dataset.r=r; d.dataset.c=c; d.textContent=board[r][c].letter; g.appendChild(d);}
}
function renderWords(){
  const ul=$("wordList"); ul.innerHTML="";
  placedWords.forEach(w=>{let li=document.createElement("li"); if(w.found) li.classList.add("found"); li.innerHTML=`<div>${w.word}</div><div>${WORDS.find(x=>x.word===w.word).hint}</div>`; ul.appendChild(li);});
}
function renderLeader(){
  $("leader").innerHTML=players.map(p=>`<div class="leader-row"><div>${p.name}</div><div>${p.score}</div></div>`).join("");
  $("teamList").innerHTML=teams.map(t=>`<div class="leader-row"><div>${t.name}</div><div>${t.score}</div></div>`).join("");
  $("playerList").innerHTML=players.map(p=>`<div class="leader-row"><div>${p.name}</div><div>${p.score}</div></div>`).join("");
}
function renderSlots(){
  const wrap=$("slotsWrap"); wrap.innerHTML="";
  slotLetters.forEach((ch,i)=>{let d=document.createElement("div"); d.className="slot"+(ch?" fill":""); d.textContent=ch; wrap.appendChild(d);});
}
function updateHUD(){
  $("hudLeft").textContent=placedWords.filter(w=>!w.found).length;
}

// selection
let selecting=false, start=null;
$("grid").addEventListener("mousedown",e=>{let r=+e.target.dataset.r,c=+e.target.dataset.c;if(isNaN(r))return;selecting=true;start={r,c};highlight([{r,c}]);});
$("grid").addEventListener("mousemove",e=>{if(!selecting)return;let r=+e.target.dataset.r,c=+e.target.dataset.c;if(isNaN(r))return;highlight(lineCells(start.r,start.c,r,c));});
window.addEventListener("mouseup",()=>{if(selecting)checkSelection(); selecting=false;});
function lineCells(r1,c1,r2,c2){let dr=Math.sign(r2-r1),dc=Math.sign(c2-c1); if(!(dr===0||dc===0||Math.abs(r2-r1)===Math.abs(c2-c1)))return[]; let len=Math.max(Math.abs(r2-r1),Math.abs(c2-c1))+1; return Array.from({length:len},(_,i)=>({r:r1+i*dr,c:c1+i*dc}));}
function highlight(cells){document.querySelectorAll(".cell").forEach(el=>el.classList.remove("sel")); cells.forEach(p=>document.querySelector(`.cell[data-r="${p.r}"][data-c="${p.c}"]`)?.classList.add("sel")); selection=cells;}
function checkSelection(){if(!selection)return; let letters=selection.map(p=>board[p.r][p.c].letter).join(""), rev=[...letters].reverse().join(""); let match=placedWords.find(w=>!w.found&&(w.word===letters||w.word===rev)); if(match){match.found=true; match.cells.forEach(p=>{board[p.r][p.c].found=true; document.querySelector(`.cell[data-r="${p.r}"][data-c="${p.c}"]`).classList.add("found");}); let pts=match.word.length; players.forEach(p=>p.score+=pts); teams.forEach(t=>t.score+=pts); bankLetters.push(match.word[0]); shuffle(bankLetters); renderWords(); renderLeader(); renderSlots(); updateHUD();}}

// teams & players
$("btnNewPlayer").onclick=()=>{let name=prompt("Player name:"); if(!name)return; players.push({id:Date.now()+Math.random(),name,score:0}); renderLeader();};
$("btnNewTeam").onclick=()=>{let name=prompt("Team name:"); if(!name)return; teams.push({id:Date.now()+Math.random(),name,score:0}); renderLeader();};

// QR update
let qr=null;
function updateQR(){document.getElementById("qrcode").innerHTML=""; qr=new QRCode(document.getElementById("qrcode"),{text:window.location.href+"?seed="+Math.random(),width:180,height:180,colorDark:"#E60000",colorLight:"#fff",correctLevel:QRCode.CorrectLevel.H});}

// buttons
$("btnShuffle").onclick=newBoard;
$("btnReset").onclick=newBoard;
$("btnStart").onclick=()=>alert("Game started!");

// init
newBoard(); renderSlots(); renderLeader();
</script>
</body>
</html>
