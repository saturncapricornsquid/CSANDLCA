<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vodafone Wordsearch ‚Äî Multiplayer</title>
<style>
  :root {
    --voda-red:#E60000; --bg:#0c0d10; --panel:#14161a; --muted:#9aa0a6; --grid:#2b2e33;
  }
  body { margin:0; font-family:Arial, sans-serif; background:var(--bg); color:white; }
  .topbar { display:flex; justify-content:space-between; align-items:center; padding:10px; background:#111; }
  .title { font-weight:900; font-size:20px; }
  .toolbar button { margin:2px; padding:6px 10px; border:none; border-radius:6px; font-weight:900; cursor:pointer; }
  .btn-primary { background:var(--voda-red); color:#fff; }
  .row { display:flex; flex-wrap:wrap; }
  .card { background:var(--panel); margin:8px; padding:8px; border-radius:8px; flex:1; min-width:280px; }
  .grid { display:grid; gap:1px; justify-content:start; }
  .cell { width:28px; height:28px; background:#000; color:#fff; display:flex; align-items:center; justify-content:center; font-weight:900; cursor:pointer; }
  .cell.selected { background:green; }
  #qrPanel { position:fixed; top:60px; left:10px; background:#fff; color:#000; padding:8px; border-radius:8px; z-index:100; }
  #qrcode { width:140px; height:140px; }
  #btnShowQR { position:fixed; bottom:10px; left:10px; background:var(--voda-red); color:#fff; border:none; border-radius:50%; padding:10px; display:none; }
  #winnerBanner { position:fixed; top:10px; right:10px; background:var(--voda-red); color:#fff; padding:8px 16px; border-radius:6px; font-weight:900; display:none; z-index:200; }
  #slots { display:flex; gap:6px; margin-top:10px; }
  .slot { width:28px; height:28px; border:2px solid #fff; display:flex; align-items:center; justify-content:center; font-weight:900; }
  li.found { text-decoration: line-through; color: var(--muted); }
</style>
</head>
<body>
<div class="topbar">
  <div class="title">Vodafone Wordsearch</div>
  <div class="toolbar">
    <button class="btn-primary" id="btnStart">Start</button>
    <button id="btnStop">Stop</button>
    <button id="btnReset">Reset</button>
    <button id="btnNewPlayer">Add Player</button>
    <button id="btnNewTeam">Add Team</button>
    <span id="hudTimer">10:00</span>
  </div>
</div>

<div id="qrPanel">
  <div>üì± Scan to Join</div>
  <div id="qrcode"></div>
  <button id="btnHideQR">Hide</button>
</div>
<button id="btnShowQR">QR</button>

<div id="winnerBanner"></div>

<div class="row">
  <div class="card">
    <h3>Leaderboard</h3>
    <div id="leader">No teams yet üèÜ</div>
    <h3>Teams</h3>
    <div id="teamList"></div>
    <h3>Players</h3>
    <div id="playerList"></div>
    <h3>Wordsearch</h3>
    <div class="grid" id="grid"></div>
  </div>
  <div class="card">
    <h3>Final Phrase</h3>
    <div id="slots"></div>
    <h3>Hints</h3>
    <ul id="hints"></ul>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
const GRID_SIZE=15;
const WORDS={
 "CORE":"Backbone of the network layer that sits beyond access",
 "SITETRACKER":"The deployment operations tool used for projects, milestones and dashboards",
 "ALLOCATION":"Which activity involves assigning specific responsibilities or resources to a deployment task?",
 "NCT":"System used by all regions to allocate sites to INOC (abbr.)",
 "DELIVERY":"Phase where circuits are provisioned and site is handed over for live service",
 "LCA":"Team responsible for pre-build before site goes live (abbr.)",
 "CRQ":"Formal change request code used in delivery/go live (abbr.)",
 "AUDIT":"Essential ECS action to ensure accurate site data before deployment",
 "TESTING":"Process of verifying new configuration/service before deployment",
 "ESCALATION":"Raising a fault/issue to higher-level support or management",
 "ACHIEVEMENT":"A successful delivery milestone",
 "METRIC":"Performance indicators used to track rollout/fault/service uptime",
 "TEAM":"Represents collaboration, added as final puzzle word"
};
const TARGET_PHRASE="CSANDLCATEAM";

let board=[],time=600,timerInt=null,bestTime=null;
let players=[],teams=[],points=0,phraseProgress=[];

const $=id=>document.getElementById(id);

function buildBoard(){
  board=[];
  for(let r=0;r<GRID_SIZE;r++){
    let row=[];
    for(let c=0;c<GRID_SIZE;c++){
      row.push(String.fromCharCode(65+Math.floor(Math.random()*26)));
    }
    board.push(row);
  }
  renderBoard();
}
function renderBoard(){
  const g=$("grid");
  g.style.gridTemplateColumns=`repeat(${GRID_SIZE},28px)`;
  g.innerHTML="";
  board.forEach((row,r)=>row.forEach((ch,c)=>{
    const d=document.createElement("div");
    d.className="cell";
    d.textContent=ch;
    d.dataset.row=r; d.dataset.col=c;
    g.appendChild(d);
  }));
}
function buildSlots(){
  phraseProgress=new Array(TARGET_PHRASE.length).fill("");
  const s=$("slots");s.innerHTML="";
  TARGET_PHRASE.split("").forEach(()=> {
    const d=document.createElement("div");
    d.className="slot";
    d.textContent="";
    s.appendChild(d);
  });
}
function buildHints(){
  const ul=$("hints"); ul.innerHTML="";
  for(const [w,hint] of Object.entries(WORDS)){
    const li=document.createElement("li");
    li.id="hint-"+w;
    li.textContent=`${hint}`;
    ul.appendChild(li);
  }
}
function updateSlots(){
  const slots=$("slots").children;
  phraseProgress.forEach((ch,i)=>{ slots[i].textContent=ch; });
}
function updateLeaderboard(){
  $("leader").textContent=`Total Points: ${points}`;
}
function wordFound(word){
  if(!$("hint-"+word).classList.contains("found")){
    $("hint-"+word).classList.add("found");
    points+=10; updateLeaderboard();
    const first=word[0]; 
    let idx=TARGET_PHRASE.indexOf(first);
    if(idx>=0 && !phraseProgress[idx]){
      phraseProgress[idx]=first;
      updateSlots();
    }
    if(phraseProgress.join("")===TARGET_PHRASE){
      points+=20; updateLeaderboard();
      stopTimer();
      showWinner("All Players/Teams");
    }
  }
}

function updateTimer(){
  $("hudTimer").textContent=`${String(Math.floor(time/60)).padStart(2,"0")}:${String(time%60).padStart(2,"0")}`;
}
function startTimer(){clearInterval(timerInt);time=600;updateTimer();timerInt=setInterval(()=>{time--;updateTimer();if(time<=0)clearInterval(timerInt);},1000);}
function stopTimer(){clearInterval(timerInt);}
function reset(){stopTimer();time=600;updateTimer();buildBoard();buildSlots();buildHints();points=0;updateLeaderboard();$("winnerBanner").style.display="none";}

$("btnStart").onclick=startTimer;
$("btnStop").onclick=stopTimer;
$("btnReset").onclick=reset;

function showWinner(name){
  const finished=600-time;
  if(bestTime===null||finished<bestTime){
    bestTime=finished;
    const min=String(Math.floor(finished/60)).padStart(2,"0");
    const sec=String(finished%60).padStart(2,"0");
    $("winnerBanner").textContent=`üèÜ ${name} finished in ${min}:${sec}`;
    $("winnerBanner").style.display="block";
  }
}

function buildQR(){
  const url=location.href.split("?")[0]+"?joined=1";
  $("qrcode").innerHTML="";
  new QRCode($("qrcode"),{text:url,width:140,height:140,colorDark:"#E60000",colorLight:"#fff"});
}
function hideQR(){ $("qrPanel").style.display="none"; $("btnShowQR").style.display="block"; }
function showQR(){ $("qrPanel").style.display="block"; $("btnShowQR").style.display="none"; buildQR(); }
$("btnHideQR").onclick=hideQR;
$("btnShowQR").onclick=showQR;

if(new URLSearchParams(location.search).get("joined")==="1"){ hideQR(); }
else{ buildQR(); setTimeout(hideQR,10000); }

buildBoard(); buildSlots(); buildHints(); updateTimer(); updateLeaderboard();
</script>
</body>
</html>
