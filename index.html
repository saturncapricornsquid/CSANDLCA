<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vodafone Wordsearch — Multiplayer</title>
<style>
  :root{
    --voda-red:#E60000; --bg:#0c0d10; --panel:#14161a; --muted:#9aa0a6;
    --grid:#2b2e33; --good:#16a34a; --bad:#dc2626; --chip:#1f2226;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:#fff;
            font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .container{max-width:1200px;margin:0 auto;padding:12px}
  .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap;margin-bottom:12px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:40px;height:40px;border-radius:999px;background:var(--voda-red)}
  .title{font-weight:900;font-size:22px}
  .subtitle{color:var(--muted);font-size:13px}
  .row{display:grid;grid-template-columns:1fr 420px;gap:16px}
  @media (max-width:900px){.row{grid-template-columns:1fr}}
  .card{background:var(--panel);border:1px solid #24262b;border-radius:14px}
  .card-header{padding:12px 14px;display:flex;align-items:center;justify-content:space-between}
  .card-title{font-weight:800}
  .card-content{padding:12px 14px 14px}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .btn{appearance:none;border:1px solid #2a2c31;background:#1a1c20;color:#fff;
       cursor:pointer;padding:8px 12px;border-radius:12px;font-weight:800;font-size:14px}
  .btn-primary{background:var(--voda-red);border-color:var(--voda-red)}
  .btn:disabled{opacity:.5;cursor:default}
  .pill{padding:6px 10px;border-radius:999px;font-size:12px;border:1px solid #2a2c31;background:#121317}
  .grid-wrap{display:inline-block;padding:8px;border-radius:12px;border:1px solid #24262b;background:#0f1013}
  .grid{display:grid;gap:0;user-select:none;touch-action:none;background:var(--grid)}
  .cell{width:32px;height:32px;display:flex;align-items:center;justify-content:center;
        font-weight:900;font-size:16px;color:#e9eaed;background:#101217;
        border-right:1px solid #24262b;border-bottom:1px solid #24262b;cursor:pointer}
  @media (min-width:700px){
    .cell{width:44px;height:44px;font-size:18px}
  }
  .cell.sel{background:rgba(230,0,0,.22)}
  .cell.found{background:var(--voda-red);color:#fff}
  .list{list-style:none;margin:0;padding:0;display:grid;gap:8px}
  .list li{padding:10px;border:1px solid #24262b;border-radius:12px;
           display:flex;justify-content:space-between;gap:12px;align-items:start;background:#0f1013}
  .list li.found div{color:var(--muted);text-decoration:line-through}
  .hint{font-size:12px;color:var(--muted);margin-top:4px}
  .bank{display:flex;gap:8px;flex-wrap:wrap;padding:8px;border:1px dashed #2a2c31;
        border-radius:10px;background:#0c0d10;min-height:56px}
  .chip{min-width:44px;height:44px;border-radius:10px;border:1px solid #2a2c31;background:var(--chip);
        display:flex;align-items:center;justify-content:center;font-weight:900;font-size:20px;cursor:grab}
  .slots{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
  .slot{width:44px;height:44px;border-radius:10px;border:2px dashed #2a2c31;background:#0b0c0f;
        display:flex;align-items:center;justify-content:center;font-weight:900;font-size:20px;color:#6b7280}
  .slot.fill{border-style:solid;color:#fff}
  .leader{display:grid;gap:8px}
  .leader-row{display:flex;justify-content:space-between;align-items:center;
              padding:8px;border:1px solid #2a2c31;border-radius:10px;background:#0f1013}
  #qrPanel{position:fixed;top:10px;right:10px;z-index:999;background:#fff;
           padding:6px;border-radius:8px;box-shadow:0 0 8px rgba(0,0,0,0.25);text-align:center}
  #qrPanel canvas{width:120px!important;height:120px!important}
  @media(max-width:600px){#qrPanel canvas{width:80px!important;height:80px!important}}
</style>
</head>
<body>
<div id="qrPanel">
  <div id="qrcode"></div>
  <div style="font-size:12px;color:#333;margin-top:2px;">Scan me</div>
</div>

<div class="container">
  <div class="topbar">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <div class="title">Vodafone Wordsearch</div>
        <div class="subtitle">Multiplayer Challenge</div>
      </div>
    </div>
    <div class="toolbar">
      <button class="btn btn-ghost" id="btnShuffle">Shuffle</button>
      <button class="btn btn-primary" id="btnStart">Start</button>
      <button class="btn" id="btnStop">Stop</button>
      <button class="btn" id="btnReset">Reset</button>
      <button class="btn" id="btnNewPlayer">Add Player</button>
      <button class="btn" id="btnNewTeam">Add Team</button>
      <span class="pill">Words left: <span id="hudLeft">0</span></span>
      <span class="pill">Time: <span id="hudTimer">10:00</span></span>
    </div>
  </div>

  <div class="row">
    <!-- Left: grid + leaderboard -->
    <div class="card">
      <div class="card-header"><div class="card-title">Puzzle</div></div>
      <div class="card-content">
        <div style="font-weight:900">Leaderboard</div>
        <div class="leader" id="leader"></div>
        <div style="margin-top:12px;font-weight:900">Teams</div>
        <div id="teamList" class="leader"></div>
        <div style="margin-top:12px;font-weight:900">Players</div>
        <div id="playerList" class="leader"></div>
        <div class="grid-wrap" style="margin-top:12px"><div id="grid" class="grid"></div></div>
      </div>
    </div>

    <!-- Right: words + final phrase -->
    <div class="card">
      <div class="card-header"><div class="card-title">Info Panel</div></div>
      <div class="card-content">
        <div style="margin-bottom:16px;">
          <div style="font-weight:900">Final Phrase</div>
          <div id="slotsWrap" class="slots"></div>
          <div style="font-weight:900;margin-top:8px">Letter Bank</div>
          <div id="bank" class="bank"></div>
        </div>
        <div style="margin-top:12px;font-weight:900">Words to Find</div>
        <ul id="wordList" class="list"></ul>
      </div>
    </div>
  </div>
</div>

<!-- QR generator -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
/* ========= Config ========= */
const GRID_SIZE = 15;
const WORDS = [
  {word:"CORE", hint:"Backbone of the network layer that sits beyond access"},
  {word:"SITETRACKER", hint:"The deployment operations tool used for projects, milestones and dashboards."},
  {word:"ALLOCATION", hint:"Which activity involves assigning specific responsibilities or resources to a deployment task?"},
  {word:"NCT", hint:"System used by all regions to allocate sites to INOC (abbr.)."},
  {word:"DELIVERY", hint:"Phase where circuits are provisioned, and a site is handed over for live service"},
  {word:"LCA", hint:"Which team is responsible for setting up pre-build, before a site goes live? (abbr.)"},
  {word:"CRQ", hint:"Formal change request code used in delivery/go live processes (abbr.)"},
  {word:"AUDIT", hint:"Essential Connectivity Services action to ensure accurate site data before deployment"},
  {word:"TESTING", hint:"Process of verifying that a new configuration or service behaves as expected before deployment"},
  {word:"ESCALATION", hint:"The act of raising a fault or issue to higher-level support or management"},
  {word:"ACHIEVEMENTS", hint:"A successful delivery milestone, e.g. completing a logical configuration"},
  {word:"METRIC", hint:"Performance indicators used to track rollout speed, fault resolution, or service uptime"},
  {word:"TEAM", hint:"The foundation of collaboration and collective success"}
];
const TARGET_PHRASE = "CSANDLCA TEAM"; // stays hidden

/* ========= State ========= */
let board = [];
let placedWords = [];
let bankLetters = [];
let slotLetters = Array.from(TARGET_PHRASE, ch => ch===' ' ? ' ' : '');
let players = [];
let teams = [];
let gameTimer = null;
let timeRemaining = 600;

/* ========= Utils ========= */
const $ = id => document.getElementById(id);
const rand = n => Math.floor(Math.random()*n);
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=rand(i+1);[a[i],a[j]]=[a[j],a[i]];}return a;}
function fmtTime(sec){const m=String(Math.floor(sec/60)).padStart(2,'0');const s=String(sec%60).padStart(2,'0');return m+":"+s;}

/* ========= Board ========= */
function newBoard(){
  board = Array.from({length:GRID_SIZE},()=>Array.from({length:GRID_SIZE},()=>({letter:''})));
  placedWords=[];
  WORDS.forEach(w=>placeWord(w.word));
  for(let r=0;r<GRID_SIZE;r++)for(let c=0;c<GRID_SIZE;c++)if(!board[r][c].letter) board[r][c].letter=String.fromCharCode(65+rand(26));
  renderBoard(); renderWords(); updateHUD();
}
function placeWord(word){
  const dirs=[[0,1],[1,0],[1,1],[1,-1],[-1,0],[0,-1],[-1,-1],[-1,1]];
  shuffle(dirs);
  for(let attempt=0;attempt<500;attempt++){
    const [dr,dc]=dirs[attempt%dirs.length];
    let r0=rand(GRID_SIZE),c0=rand(GRID_SIZE),cells=[],ok=true;
    for(let i=0;i<word.length;i++){
      const r=r0+dr*i,c=c0+dc*i;
      if(r<0||c<0||r>=GRID_SIZE||c>=GRID_SIZE){ok=false;break;}
      if(board[r][c].letter && board[r][c].letter!==word[i]){ok=false;break;}
      cells.push({r,c});
    }
    if(ok){cells.forEach((p,i)=>board[p.r][p.c].letter=word[i]);placedWords.push({word,cells,found:false});return;}
  }
}
function renderBoard(){
  const g=$("grid"); g.style.gridTemplateColumns=`repeat(${GRID_SIZE},auto)`; g.innerHTML="";
  for(let r=0;r<GRID_SIZE;r++)for(let c=0;c<GRID_SIZE;c++){
    const d=document.createElement("div");d.className="cell";d.dataset.r=r;d.dataset.c=c;d.textContent=board[r][c].letter;
    g.appendChild(d);
  }
}
function renderWords(){
  const ul=$("wordList"); ul.innerHTML="";
  placedWords.forEach(w=>{
    const li=document.createElement("li");if(w.found) li.classList.add("found");
    li.innerHTML=`<div><div style="font-weight:900">${w.word}</div><div class="hint">${WORDS.find(x=>x.word===w.word).hint}</div></div>
                  <div>${w.found?"✓":"…"}</div>`;
    ul.appendChild(li);
  });
}
function updateHUD(){
  $("hudLeft").textContent=placedWords.filter(w=>!w.found).length;
  $("hudTimer").textContent=fmtTime(timeRemaining);
}

/* ========= Selection ========= */
let selecting=false,start=null;
function cellAt(ev){const t=ev.target.closest(".cell");if(!t) return null;return{r:+t.dataset.r,c:+t.dataset.c};}
function lineCells(sr,sc,er,ec){const dr=Math.sign(er-sr),dc=Math.sign(ec-sc);if(!(dr===0||dc===0||Math.abs(er-sr)===Math.abs(ec-sc))) return[];const len=Math.max(Math.abs(er-sr),Math.abs(ec-sc))+1,cells=[];for(let i=0;i<len;i++)cells.push({r:sr+i*dr,c:sc+i*dc});return cells;}
function startSel(e){const p=cellAt(e);if(!p) return;selecting=true;start=p;highlight([p]);}
function moveSel(e){if(!selecting) return;const p=cellAt(e);if(!p) return;highlight(lineCells(start.r,start.c,p.r,p.c));}
function endSel(){if(!selecting) return;selecting=false;checkSelection();}
function highlight(cells){document.querySelectorAll(".cell.sel").forEach(el=>el.classList.remove("sel"));cells.forEach(p=>document.querySelector(`.cell[data-r="${p.r}"][data-c="${p.c}"]`)?.classList.add("sel"));selection=cells;}
function checkSelection(){const letters=selection.map(p=>board[p.r][p.c].letter).join(""),rev=letters.split("").reverse().join("");let match=placedWords.find(w=>!w.found&&(w.word===letters||w.word===rev));if(match){match.found=true;selection.forEach(p=>document.querySelector(`.cell[data-r="${p.r}"][data-c="${p.c}"]`).classList.add("found"));bankLetters.push(match.word[0]);renderWords();renderBank();updateHUD();}}
let selection=[];

/* ========= Bank & Slots ========= */
function renderBank(){const b=$("bank");b.innerHTML="";bankLetters.forEach((ch,i)=>{const d=document.createElement("div");d.className="chip";d.textContent=ch;d.draggable=true;d.addEventListener("dragstart",e=>e.dataTransfer.setData("text/plain","bank:"+i));b.appendChild(d);});}
function renderSlots(){const w=$("slotsWrap");w.innerHTML="";slotLetters.forEach((ch,i)=>{const d=document.createElement("div");d.className="slot"+(ch?" fill":"");d.dataset.i=i;d.textContent=ch||"";d.addEventListener("dragover",e=>e.preventDefault());d.addEventListener("drop",e=>{e.preventDefault();const data=e.dataTransfer.getData("text/plain");if(data.startsWith("bank:")){const idx=+data.split(":")[1];slotLetters[i]=bankLetters[idx];bankLetters.splice(idx,1);renderSlots();renderBank();}});w.appendChild(d);});}

/* ========= Teams & Players ========= */
function addTeam(){const n=prompt("Team name?");if(!n) return;teams.push({name:n,score:0});renderTeams();}
function addPlayer(){const n=prompt("Player name?");if(!n) return;players.push({name:n,score:0});renderPlayers();}
function renderTeams(){$("teamList").innerHTML=teams.map(t=>`<div class="leader-row"><div>${t.name}</div><div>${t.score}</div></div>`).join("");}
function renderPlayers(){$("playerList").innerHTML=players.map(p=>`<div class="leader-row"><div>${p.name}</div><div>${p.score}</div></div>`).join("");}
function renderLeader(){const L=$("leader");L.innerHTML="";const top=[...players].sort((a,b)=>b.score-a.score);top.forEach((p,i)=>{L.innerHTML+=`<div class="leader-row"><div>${i+1}. ${p.name}</div><div>${p.score}</div></div>`});}

/* ========= Timer ========= */
function startTimer(){clearInterval(gameTimer);timeRemaining=600;gameTimer=setInterval(()=>{timeRemaining--;updateHUD();if(timeRemaining<=0)clearInterval(gameTimer);},1000);}
function stopTimer(){clearInterval(gameTimer);}
function resetRound(){clearInterval(gameTimer);timeRemaining=600;bankLetters=[];slotLetters=Array.from(TARGET_PHRASE,ch=>ch===' ' ? ' ' : '');newBoard();renderSlots();
