<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vodafone Wordsearch</title>
<style>
  :root {
    --voda-red:#E60000; --bg:#0c0d10; --panel:#14161a;
    --muted:#9aa0a6; --grid:#2b2e33; --chip:#1f2226;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:#fff;font-family:Inter,Arial,sans-serif}
  .container{max-width:1200px;margin:0 auto;padding:10px}
  .topbar{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-bottom:10px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{width:40px;height:40px;border-radius:50%;background:var(--voda-red)}
  .title{font-weight:900;font-size:20px}
  .subtitle{font-size:12px;color:var(--muted)}
  .toolbar{display:flex;gap:6px;flex-wrap:wrap}
  .btn{border:1px solid #2a2c31;background:#1a1c20;color:#fff;padding:6px 10px;border-radius:8px;font-weight:700;cursor:pointer}
  .btn-primary{background:var(--voda-red);border-color:var(--voda-red)}
  .btn:disabled{opacity:.5;cursor:default}
  .pill{padding:4px 8px;border-radius:999px;background:#121317;border:1px solid #2a2c31;font-size:12px}
  .row{display:grid;grid-template-columns:1fr 380px;gap:12px}
  @media(max-width:900px){.row{grid-template-columns:1fr}}
  .card{background:var(--panel);border:1px solid #24262b;border-radius:10px;overflow:hidden}
  .card-header{padding:8px 10px;font-weight:800;border-bottom:1px solid #24262b}
  .card-content{padding:10px}
  .grid-wrap{display:inline-block;border:1px solid #24262b;border-radius:10px;background:#0f1013;overflow:auto}
  .grid{display:grid;user-select:none}
  .cell{width:30px;height:30px;display:flex;align-items:center;justify-content:center;
        font-weight:800;font-size:14px;color:#e9eaed;border:1px solid #24262b;cursor:pointer}
  .cell.sel{background:rgba(230,0,0,.25)}
  .cell.hit{background:rgba(22,163,74,.65)!important}
  .cell.miss{background:rgba(220,38,38,.65)!important}
  .cell.found{background:var(--voda-red)!important;color:#fff}
  ul.list{list-style:none;padding:0;margin:0;display:grid;gap:6px}
  .list li{padding:6px;border:1px solid #2a2c31;border-radius:8px;background:#0f1013}
  .list li.found{color:var(--muted);text-decoration:line-through}
  .hint{font-size:11px;color:var(--muted)}
  .bank,.slots{display:flex;gap:6px;flex-wrap:wrap;min-height:40px;padding:6px;border:1px dashed #2a2c31;border-radius:8px;background:#0b0c0f}
  .chip{min-width:28px;height:28px;background:var(--chip);border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:14px}
  .chip[draggable=true]{cursor:grab}
  .slot{width:32px;height:32px;border:2px dashed #2a2c31;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:14px;color:#6b7280}
  .slot.fill{border-style:solid;color:#fff}
  .leader{display:grid;gap:6px}
  .leader-row{display:flex;justify-content:space-between;padding:4px 6px;background:#0f1013;border:1px solid #2a2c31;border-radius:6px}
  #winnerBanner{background:var(--voda-red);color:#fff;padding:6px;font-weight:900;text-align:center;display:none;position:sticky;top:0;z-index:50}
  /* QR */
  #qrPanel{position:fixed;top:10px;left:10px;z-index:999;background:#fff;padding:6px 6px 2px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.4);text-align:center;width:110px}
  #qrPanel canvas{width:100%!important;height:auto!important}
  #qrPanel .label{font-size:11px;color:#333}
</style>
</head>
<body>
<div id="qrPanel">
  <div id="qrcode"></div>
  <div class="label">📱 Scan Me</div>
</div>

<div id="winnerBanner"></div>

<div class="container">
  <div class="topbar">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <div class="title">Vodafone Wordsearch</div>
        <div class="subtitle">Multiplayer Challenge</div>
      </div>
    </div>
    <div class="toolbar">
      <button class="btn btn-ghost" id="btnShuffle">Shuffle</button>
      <button class="btn btn-primary" id="btnStart">Start</button>
      <button class="btn" id="btnStop">Stop</button>
      <button class="btn" id="btnReset">Reset</button>
      <button class="btn" id="btnNewPlayer">Add Player</button>
      <button class="btn" id="btnNewTeam">Add Team</button>
      <span class="pill">Words left: <span id="hudLeft">0</span></span>
      <span class="pill">Time: <span id="hudTimer">10:00</span></span>
    </div>
  </div>

  <div class="row">
    <!-- Left -->
    <div class="card">
      <div class="card-header">Puzzle</div>
      <div class="card-content">
        <div style="font-weight:900">Leaderboard</div>
        <div id="leader" class="leader"></div>
        <div style="margin-top:8px;font-weight:900">Teams</div>
        <div id="teamList" class="leader"></div>
        <div style="margin-top:8px;font-weight:900">Players</div>
        <div id="playerList" class="leader"></div>
        <div class="grid-wrap"><div id="grid" class="grid"></div></div>
      </div>
    </div>
    <!-- Right -->
    <div class="card">
      <div class="card-header">Info Panel</div>
      <div class="card-content">
        <div style="font-weight:900">Final Phrase</div>
        <div id="bank" class="bank"></div>
        <div style="font-weight:900;margin-top:6px">Slots</div>
        <div id="slotsWrap" class="slots"></div>
        <div style="margin-top:8px;font-weight:900">Words to Find</div>
        <ul id="wordList" class="list"></ul>
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
/* ==== Config ==== */
const GRID_SIZE = 15;
const WORDS = [
  {word:"CORE",hint:"Backbone of the network layer that sits beyond access"},
  {word:"SITETRACKER",hint:"The deployment operations tool used for projects, milestones and dashboards."},
  {word:"ALLOCATION",hint:"Which activity involves assigning specific responsibilities or resources to a deployment task?"},
  {word:"NCT",hint:"System used by all regions to allocate sites to INOC (abbr.)."},
  {word:"DELIVERY",hint:"Phase where circuits are provisioned, and a site is handed over for live service"},
  {word:"LCA",hint:"Which team sets up pre-build before a site goes live? (abbr.)"},
  {word:"CRQ",hint:"Formal change request code used in delivery/go live processes (abbr.)."},
  {word:"AUDIT",hint:"Essential Connectivity Services action to ensure accurate site data before deployment"},
  {word:"TESTING",hint:"Process of verifying a new configuration/service behaves as expected before deployment"},
  {word:"ESCALATION",hint:"Act of raising a fault or issue to higher-level support or management"},
  {word:"ACHIEVEMENTS",hint:"A successful delivery milestone"},
  {word:"METRIC",hint:"Performance indicators for rollout speed, fault resolution, or uptime"},
  {word:"TEAM",hint:"Collaboration group working together toward delivery success"}
];
const TARGET_PHRASE = "CSANDLCA TEAM";

/* ==== State ==== */
let board, placedWords, players=[], teams=[], bankLetters=[], slotLetters, finalSolved=null;
let gameTimer=null,timeRemaining=600; let selecting=false,start=null,selection={cells:[]};

/* ==== Utils ==== */
const $=id=>document.getElementById(id);
const rand=n=>Math.floor(Math.random()*n);
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=rand(i+1);[a[i],a[j]]=[a[j],a[i]];}return a;}
function fmtTime(s){const m=String(Math.floor(s/60)).padStart(2,"0");const sec=String(s%60).padStart(2,"0");return `${m}:${sec}`;}

/* ==== Board ==== */
function newBoard(){
  board=Array.from({length:GRID_SIZE},()=>Array.from({length:GRID_SIZE},()=>({letter:"",found:false})));
  placedWords=[];
  WORDS.forEach(w=>placeWord(w.word));
  for(let r=0;r<GRID_SIZE;r++){for(let c=0;c<GRID_SIZE;c++){if(!board[r][c].letter)board[r][c].letter=String.fromCharCode(65+rand(26));}}
  renderBoard();renderWords();updateHUD();
}
function placeWord(word){
  const dirs=[[0,1],[1,0],[1,1],[1,-1],[0,-1],[-1,0],[-1,-1],[-1,1]];
  for(let attempt=0;attempt<500;attempt++){
    const [dr,dc]=dirs[rand(dirs.length)],r0=rand(GRID_SIZE),c0=rand(GRID_SIZE);
    let cells=[],ok=true;
    for(let i=0;i<word.length;i++){const r=r0+dr*i,c=c0+dc*i;
      if(r<0||c<0||r>=GRID_SIZE||c>=GRID_SIZE){ok=false;break;}
      if(board[r][c].letter && board[r][c].letter!==word[i]){ok=false;break;}
      cells.push({r,c});
    }
    if(ok){cells.forEach((p,i)=>board[p.r][p.c].letter=word[i]);placedWords.push({word,cells,found:false});return;}
  }
}
function renderBoard(){
  const g=$("grid");g.style.gridTemplateColumns=`repeat(${GRID_SIZE},30px)`;g.innerHTML="";
  for(let r=0;r<GRID_SIZE;r++){for(let c=0;c<GRID_SIZE;c++){
    const d=document.createElement("div");d.className="cell";d.dataset.r=r;d.dataset.c=c;d.textContent=board[r][c].letter;if(board[r][c].found)d.classList.add("found");g.appendChild(d);
  }}
}
function renderWords(){
  const ul=$("wordList");ul.innerHTML="";placedWords.forEach(w=>{
    const li=document.createElement("li");li.innerHTML=`<div style="font-weight:900">${w.word}</div><div class="hint">${WORDS.find(x=>x.word===w.word).hint}</div>`;if(w.found)li.classList.add("found");ul.appendChild(li);
  });
}

/* ==== Selection ==== */
function cellAt(ev){const t=ev.target.closest(".cell");if(!t)return null;return{r:+t.dataset.r,c:+t.dataset.c};}
function lineCells(sr,sc,er,ec){const dr=Math.sign(er-sr),dc=Math.sign(ec-sc);if(!(dr===0||dc===0||Math.abs(er-sr)===Math.abs(ec-sc)))return[];const len=Math.max(Math.abs(er-sr),Math.abs(ec-sc))+1;return Array.from({length:len},(_,i)=>({r:sr+i*dr,c:sc+i*dc}));}
function startSel(e){const p=cellAt(e);if(!p)return;selecting=true;start=p;selection.cells=[p];highlightSel();}
function moveSel(e){if(!selecting)return;const p=cellAt(e);if(!p)return;selection.cells=lineCells(start.r,start.c,p.r,p.c);highlightSel();}
function endSel(){if(!selecting)return;selecting=false;const letters=selection.cells.map(p=>board[p.r][p.c].letter).join("");const rev=[...letters].reverse().join("");const match=placedWords.find(w=>!w.found&&(w.word===letters||w.word===rev));if(match){selection.cells.forEach(p=>board[p.r][p.c].found=true);match.found=true;bankLetters.push(match.word[0]);shuffle(bankLetters);renderBoard();renderWords();renderLetterBank();renderSlots();updateHUD();renderLeader();checkGameEnd();}selection.cells=[];}
function highlightSel(){document.querySelectorAll(".cell").forEach(el=>el.classList.remove("sel"));selection.cells.forEach(p=>document.querySelector(`.cell[data-r="${p.r}"][data-c="${p.c}"]`)?.classList.add("sel"));}

/* ==== Bank & Slots ==== */
function renderLetterBank(){$("bank").innerHTML="";bankLetters.forEach((ch,i)=>{const d=document.createElement("div");d.className="chip";d.draggable=true;d.textContent=ch;d.addEventListener("dragstart",e=>e.dataTransfer.setData("text/plain","b:"+i));$("bank").appendChild(d);});}
function renderSlots(){$("slotsWrap").innerHTML="";Array.from(TARGET_PHRASE).forEach((ch,i)=>{const s=document.createElement("div");s.className="slot"+(slotLetters[i]?" fill":"");s.dataset.i=i;s.textContent=slotLetters[i]||"";s.addEventListener("dragover",e=>e.preventDefault());s.addEventListener("drop",e=>{e.preventDefault();const d=e.dataTransfer.getData("text/plain");if(d.startsWith("b:")){const idx=+d.split(":")[1];const ch=bankLetters[idx];slotLetters[i]=ch;bankLetters.splice(idx,1);renderLetterBank();renderSlots();checkGameEnd();}});$("slotsWrap").appendChild(s);});}

/* ==== HUD ==== */
function updateHUD(){$("hudLeft").textContent=placedWords.filter(w=>!w.found).length;$("hudTimer").textContent=fmtTime(timeRemaining);}
function renderLeader(){const L=$("leader");L.innerHTML="";const topPlayer=players.sort((a,b)=>b.score-a.score)[0];const topTeam=teams.sort((a,b)=>b.score-a.score)[0];if(topPlayer)L.innerHTML+=`<div class="leader-row">🏆 ${topPlayer.name} (${topPlayer.score})</div>`;if(topTeam)L.innerHTML+=`<div class="leader-row">🏆 Team ${topTeam.name} (${topTeam.score})</div>`;}

/* ==== Timer ==== */
function startTimer(){clearInterval(gameTimer);timeRemaining=600;gameTimer=setInterval(()=>{timeRemaining--;updateHUD();if(timeRemaining<=0){clearInterval(gameTimer);alert("⏱ Time's up!");}},1000);}
function stopTimer(){clearInterval(gameTimer);}
function resetGame(){clearInterval(gameTimer);timeRemaining=600;bankLetters=[];slotLetters=Array.from(TARGET_PHRASE,ch=>ch===' '?"":"");placedWords.forEach(w=>w.found=false);players.forEach(p=>p.score=0);teams.forEach(t=>t.score=0);newBoard();renderLetterBank();renderSlots();renderLeader();updateHUD();$("winnerBanner").style.display="none";}

/* ==== End ==== */
function allDone(){return placedWords.every(w=>w.found)&&slotLetters.join("")===TARGET_PHRASE;}
function checkGameEnd(){if(allDone()){clearInterval(gameTimer);const t=fmtTime(600-timeRemaining);$("winnerBanner").style.display="block";$("winnerBanner").textContent=`🏁 Finished in ${t}`;}}

/* ==== Players/Teams ==== */
$("btnNewPlayer").onclick=()=>{const n=prompt("Player name?");if(!n)return;players.push({name:n,score:0});renderLeader();}
$("btnNewTeam").onclick=()=>{const n=prompt("Team name?");if(!n)return;teams.push({name:n,score:0});renderLeader();}

/* ==== Events ==== */
$("btnShuffle").onclick=newBoard;
$("btnStart").onclick=startTimer;
$("btnStop").onclick=stopTimer;
$("btnReset").onclick=resetGame;
$("grid").addEventListener("mousedown",startSel);$("grid").addEventListener("mousemove",moveSel);window.addEventListener("mouseup",endSel);

/* ==== Init ==== */
slotLetters=Array.from(TARGET_PHRASE,ch=>ch===' '?"":"");newBoard();renderLetterBank();renderSlots();updateHUD();

/* ==== QR ==== */
new QRCode(document.getElementById("qrcode"),{text:window.location.href,width:100,height:100,colorDark:"#E60000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});
</script>
</body>
</html>
