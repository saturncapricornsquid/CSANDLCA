<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vodafone Wordsearch — Multiplayer</title>
<style>
  :root {
    --voda-red:#E60000; --bg:#0c0d10; --panel:#14161a; --muted:#9aa0a6;
    --grid:#2b2e33; --good:#16a34a; --bad:#dc2626; --chip:#1f2226;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:#fff;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .container{max-width:1200px;margin:0 auto;padding:12px}
  .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap;margin-bottom:12px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:40px;height:40px;border-radius:999px;background:var(--voda-red)}
  .title{font-weight:900;font-size:22px}
  .subtitle{color:var(--muted);font-size:13px}
  .qr-box{margin-top:8px;text-align:center}
  #qrcode{margin:0 auto}
  @media(max-width:600px){ #qrcode canvas{width:140px!important;height:140px!important} }
  .row{display:grid;grid-template-columns:1fr 420px;gap:16px}
  @media (max-width:1080px){.row{grid-template-columns:1fr}}
  .card{background:var(--panel);border:1px solid #24262b;border-radius:14px}
  .card-header{padding:10px 14px;display:flex;align-items:center;justify-content:space-between}
  .card-title{font-weight:800}
  .card-content{padding:10px 14px 14px}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .btn{appearance:none;border:1px solid #2a2c31;background:#1a1c20;color:#fff;cursor:pointer;
       padding:7px 12px;border-radius:10px;font-weight:700;font-size:14px}
  .btn-primary{background:var(--voda-red);border-color:var(--voda-red)}
  .pill{padding:5px 9px;border-radius:999px;font-size:12px;border:1px solid #2a2c31;background:#121317}
  .grid-wrap{display:inline-block;padding:6px;border-radius:12px;border:1px solid #24262b;background:#0f1013}
  .grid{display:grid;gap:0;user-select:none;touch-action:none;background:var(--grid)}
  .cell{width:32px;height:32px;display:flex;align-items:center;justify-content:center;
        font-weight:700;font-size:15px;color:#e9eaed;background:#101217;
        border-right:1px solid #24262b;border-bottom:1px solid #24262b;cursor:pointer}
  @media(min-width:768px){.cell{width:40px;height:40px;font-size:17px}}
  .cell.sel{background:rgba(230,0,0,.22)}
  .cell.hit{background:rgba(22,163,74,.65)!important;color:#fff!important}
  .cell.miss{background:rgba(220,38,38,.65)!important;color:#fff!important}
  .cell.found{background:var(--voda-red);color:#fff}
  .list{list-style:none;margin:0;padding:0;display:grid;gap:8px}
  .list li{padding:8px;border:1px solid #2a2c31;border-radius:12px;
           display:flex;justify-content:space-between;gap:12px;align-items:start;background:#0f1013}
  .list li.found div{color:var(--muted);text-decoration:line-through}
  .hint{font-size:12px;color:var(--muted);margin-top:3px}
  .leader{display:grid;gap:8px;margin-top:8px}
  .leader-row{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;
              border:1px solid #2a2c31;border-radius:10px;background:#0f1013;font-size:14px}
  #winnerBanner{display:none;background:#E60000;color:white;font-weight:900;font-size:18px;
                padding:10px;text-align:center;border-radius:8px;margin-bottom:8px}
</style>
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <div class="title">Vodafone Wordsearch</div>
        <div class="subtitle">Multiplayer Challenge</div>
        <div class="qr-box">
          <div id="qrcode"></div>
          <div style="font-size:12px;color:#aaa;">📱 Scan to Join</div>
        </div>
      </div>
    </div>
    <div class="toolbar">
      <button class="btn btn-ghost" id="btnShuffle">Shuffle</button>
      <button class="btn btn-primary" id="btnStart">Start</button>
      <button class="btn" id="btnStop">Stop</button>
      <button class="btn" id="btnReset">Reset</button>
      <button class="btn" id="btnNewPlayer">Add Player</button>
      <button class="btn" id="btnNewTeam">Add Team</button>
      <span class="pill">Words left: <span id="hudLeft">0</span></span>
      <span class="pill">Time: <span id="hudTimer">10:00</span></span>
      <span class="pill">Quickest: <span id="hudBest">--:--</span></span>
    </div>
  </div>
  <div id="winnerBanner"></div>

  <div class="row">
    <!-- Left column -->
    <div class="card">
      <div class="card-header"><div class="card-title">Puzzle</div></div>
      <div class="card-content">
        <div style="font-weight:900">Leaderboard</div>
        <div class="leader" id="leader"></div>
        <div style="margin-top:12px;font-weight:900">Teams</div>
        <div id="teamList" class="leader"></div>
        <div style="margin-top:12px;font-weight:900">Players</div>
        <div id="playerList" class="leader"></div>
        <div class="grid-wrap"><div id="grid" class="grid"></div></div>
      </div>
    </div>
    <!-- Right column -->
    <div class="card">
      <div class="card-header"><div class="card-title">Info Panel</div></div>
      <div class="card-content">
        <div style="margin-bottom:16px;">
          <div style="font-weight:900;">Final Phrase</div>
          <div id="slotsWrap" class="leader" style="flex-wrap:wrap;display:flex;gap:6px;margin-top:6px"></div>
        </div>
        <div style="margin-top:12px;font-weight:900">Words to Find</div>
        <ul id="wordList" class="list"></ul>
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
// Config
const GRID_SIZE = 15;
const WORDS = [
 {word:"CORE", hint:"Backbone of the network layer that sits beyond access"},
 {word:"SITETRACKER", hint:"The deployment operations tool used for projects, milestones and dashboards."},
 {word:"ALLOCATION", hint:"Assigning responsibilities or resources to a deployment task"},
 {word:"NCT", hint:"System used by all regions to allocate sites to INOC (abbr.)"},
 {word:"DELIVERY", hint:"Phase where circuits are provisioned and site handed over for live service"},
 {word:"LCA", hint:"Team responsible for pre-build before site goes live (abbr.)"},
 {word:"CRQ", hint:"Formal change request code in delivery/go live processes (abbr.)"},
 {word:"AUDIT", hint:"Action to ensure accurate site data before deployment"},
 {word:"TESTING", hint:"Process of verifying configuration/service behaves as expected before deployment"},
 {word:"ESCALATION", hint:"Act of raising a fault or issue to higher-level support or management"},
 {word:"ACHIEVEMENTS", hint:"Successful delivery milestone or fault resolution"},
 {word:"METRIC", hint:"Performance indicators to track rollout speed, fault resolution, uptime"},
 {word:"TEAM", hint:"Collaboration group working together toward delivery goals"}
];
const TARGET_PHRASE = "CSANDLCA";

// State
let board=[]; let placedWords=[];
let players=[]; let teams=[];
let selection={cells:[]};
let foundWords=0;
let bankLetters=[];
let slotLetters = Array.from(TARGET_PHRASE, ch => '');
let finalSolved=null;
let gameTimer=null, timeRemaining=600, bestTimeSeconds=null, roundActive=false;

// Utils
const $=id=>document.getElementById(id);
const rand=n=>Math.floor(Math.random()*n);
const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=rand(i+1);[a[i],a[j]]=[a[j],a[i]];}return a;}
const fmtTime=sec=>`${String(Math.floor(sec/60)).padStart(2,'0')}:${String(sec%60).padStart(2,'0')}`;

// Board generation
function newBoard(){
  board=Array.from({length:GRID_SIZE},()=>Array.from({length:GRID_SIZE},()=>({letter:'',found:false})));
  placedWords=[];
  WORDS.forEach(w=>placeWord(w.word));
  for(let r=0;r<GRID_SIZE;r++){for(let c=0;c<GRID_SIZE;c++){if(!board[r][c].letter) board[r][c].letter=String.fromCharCode(65+rand(26));}}
  renderBoard(); renderWords();
}
function placeWord(word){
  const dirs=[[0,1],[1,0],[1,1],[1,-1],[0,-1],[-1,0],[-1,-1],[-1,1]];
  shuffle(dirs);
  for(let attempt=0;attempt<800;attempt++){
    const [dr,dc]=dirs[attempt%dirs.length]; const r0=rand(GRID_SIZE),c0=rand(GRID_SIZE);
    const cells=[]; let ok=true;
    for(let i=0;i<word.length;i++){
      const r=r0+dr*i,c=c0+dc*i;
      if(r<0||c<0||r>=GRID_SIZE||c>=GRID_SIZE){ok=false;break;}
      if(board[r][c].letter && board[r][c].letter!==word[i]){ok=false;break;}
      cells.push({r,c});
    }
    if(ok){cells.forEach((p,i)=>board[p.r][p.c].letter=word[i]); placedWords.push({word,cells,found:false}); return true;}
  } return false;
}

// Rendering
function renderBoard(){
  const g=$("grid"); g.style.gridTemplateColumns=`repeat(${GRID_SIZE}, 32px)`; g.innerHTML="";
  for(let r=0;r<GRID_SIZE;r++){for(let c=0;c<GRID_SIZE;c++){
    const d=document.createElement("div"); d.className="cell"; d.dataset.r=r; d.dataset.c=c; d.textContent=board[r][c].letter;
    if(board[r][c].found) d.classList.add("found"); g.appendChild(d);
  }}}
function renderWords(){
  const ul=$("wordList"); ul.innerHTML="";
  placedWords.forEach(w=>{
    const li=document.createElement("li"); if(w.found) li.classList.add("found");
    li.innerHTML=`<div><div style='font-weight:900'>${w.word}</div><div class='hint'>${WORDS.find(x=>x.word===w.word)?.hint||""}</div></div>`;
    ul.appendChild(li);
  });
}

// Timer
function startTimer(){clearInterval(gameTimer); timeRemaining=600; roundActive=true; updateHUD();
 gameTimer=setInterval(()=>{timeRemaining--; $("hudTimer").textContent=fmtTime(timeRemaining);
 if(timeRemaining<=0){clearInterval(gameTimer); roundActive=false; alert("⏱ Time's up!");}},1000);}
function stopTimer(){clearInterval(gameTimer); roundActive=false;}
function resetRound(){document.getElementById("winnerBanner").style.display="none"; clearInterval(gameTimer);
 roundActive=false; timeRemaining=600; bankLetters=[]; slotLetters=Array.from(TARGET_PHRASE,()=>'');
 players.forEach(p=>p.score=0); teams.forEach(t=>t.score=0); newBoard(); renderLeader(); updateHUD(); renderSlots();}
function updateHUD(){$("hudLeft").textContent=placedWords.filter(w=>!w.found).length; $("hudTimer").textContent=fmtTime(timeRemaining);
 $("hudBest").textContent=bestTimeSeconds==null?"--:--":fmtTime(bestTimeSeconds);}

// Slots
function renderSlots(){
  const wrap=$("slotsWrap"); wrap.innerHTML="";
  slotLetters.forEach((ch,i)=>{
    const s=document.createElement("div"); s.className="cell"; s.textContent=ch||""; wrap.appendChild(s);
  });
}

// Leaderboard
function renderLeader(){
  const L=$("leader"); L.innerHTML="";
  const ranking=[...players].sort((a,b)=>b.score-a.score);
  ranking.forEach((p,i)=>{const row=document.createElement("div"); row.className="leader-row";
    row.innerHTML=`<div>${i+1}. ${p.name||'Player'} ${teams.find(t=>t.id===p.teamId)?.name||''}</div><div>${p.score}</div>`; L.appendChild(row);});
}

// Winner banner
function showWinner(){
  const topPlayer=[...players].sort((a,b)=>b.score-a.score)[0];
  const topTeam=[...teams].sort((a,b)=>b.score-a.score)[0];
  const banner=$("winnerBanner");
  if(topPlayer){banner.style.display="block"; banner.textContent=`🏆 Player: ${topPlayer.name} — Finished in ${fmtTime(600-timeRemaining)}`;}
  else if(topTeam){banner.style.display="block"; banner.textContent=`🏆 Team: ${topTeam.name} — Finished in ${fmtTime(600-timeRemaining)}`;}
}

// Events
$("btnShuffle").onclick=()=>{newBoard(); renderSlots();};
$("btnStart").onclick=startTimer;
$("btnStop").onclick=stopTimer;
$("btnReset").onclick=resetRound;

// QR code
new QRCode(document.getElementById("qrcode"), {
  text: window.location.href,
  width:180,
  height:180,
  colorDark:"#E60000",
  colorLight:"#ffffff",
  correctLevel:QRCode.CorrectLevel.H
});

// Boot
newBoard(); renderSlots(); updateHUD();
</script>
</body>
</html>
