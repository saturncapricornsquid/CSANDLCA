<script>
/* ... previous config, utils, state ... */

let currentSeed = Date.now(); // unique seed for the board

/* ========================
   Board Generation with Seed
   ======================== */
function seededRand(seed) {
  var x = Math.sin(seed++) * 10000;
  return x - Math.floor(x);
}
function seededShuffle(arr, seed) {
  let array = [...arr];
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(seededRand(seed + i) * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function newBoard(seed = Date.now()) {
  currentSeed = seed;
  board = Array.from({length:GRID_SIZE},()=>Array.from({length:GRID_SIZE},()=>({letter:"",found:false})));
  placedWords=[];
  WORDS.forEach(w=>placeWord(w.word));
  for(let r=0;r<GRID_SIZE;r++)for(let c=0;c<GRID_SIZE;c++)if(!board[r][c].letter)board[r][c].letter=String.fromCharCode(65+rand(26));
  renderBoard(); renderWords(); updateQR();
}

/* ========================
   QR Update
   ======================== */
function updateQR() {
  const qrDiv = $("qrcode");
  qrDiv.innerHTML = "";
  const url = window.location.origin + window.location.pathname + "?seed=" + currentSeed;
  new QRCode(qrDiv, {
    text: url,
    width: 100, height: 100,
    colorDark: "#E60000", colorLight: "#ffffff",
    correctLevel: QRCode.CorrectLevel.H
  });
}

/* ========================
   Controls
   ======================== */
$("btnStart").onclick=startTimer;
$("btnStop").onclick=()=>clearInterval(timer);
$("btnReset").onclick=()=>{ clearInterval(timer); timeRemaining=600; $("hudTimer").textContent="10:00"; newBoard(Date.now()); renderSlots(); };
$("btnShuffle").onclick=()=>{ newBoard(Date.now()); };

/* ========================
   Boot
   ======================== */
function boot(){ 
  const params = new URLSearchParams(window.location.search);
  const seed = params.get("seed") ? parseInt(params.get("seed")) : Date.now();
  newBoard(seed); renderSlots(); renderLeader(); $("hudTimer").textContent="10:00";
} 
boot();
</script>


